jQuery(function(n){function e(){n(document.body).find(".wc-shipping-simulator #fshipping-results").empty()}n("body").on("show_variation",function(i,t){var s=n(document.body).find(".wc-shipping-simulator").data("product-ids"),o=(t&&t.variation_id?t.variation_id:n('.cart input[name="variation_id"]').val()).toString();if(!t||t.is_in_stock&&!t.is_downloadable&&t.is_purchasable&&!t.is_virtual)if(void 0===s)console.log("Não foi possível identificar o ID das variações.");else{s=s.toString().split(",");if(0===n('.cart input[name="variation_id"]').length)return console.log("Não foi possível identificar o ID da variação"),!1;-1<n.inArray(o,s)&&n(document.body).find(".wc-shipping-simulator").slideDown(200),e()}else n(document.body).find(".wc-shipping-simulator").slideUp(200)}),n("body").on("reset_image",function(){wc_shipping_simulator.always_visible||n(document.body).find(".wc-shipping-simulator").slideUp(200),e()}),n(".wc-shipping-simulator .cep-number").bind("keypress",function(i){13===i.keyCode&&(i.preventDefault(),n(this).closest(".wc-shipping-simulator").find(".calculate").click())}),n(".wc-shipping-simulator .cep-number.auto-calculate").on("keyup",function(i){let t=n(this).val();t=t?t.replace(/\D/g,""):"",isFinite(i.key)&&8===t.length&&(n(this).trigger("blur"),n(this).closest(".wc-shipping-simulator").find(".calculate").click())}),"yes"===wc_shipping_simulator.enable_mask&&n(".wc-shipping-simulator .cep-number").mask("00000-000"),n(document.body).on("click",".wc-shipping-simulator .calculate",function(i){i.preventDefault();i=wc_shipping_simulator.summaryContainer;simulator=n(this).closest(".wc-shipping-simulator"),content=simulator.find("#fshipping-results"),button=n(this),type=simulator.data("product-type"),product_id=n('.cart [name="add-to-cart"]').val(),all_fields=n(".cart").serialize(),button.addClass("loading"),simulator.addClass("loading"),content.empty();let t={action:"wc_shipping_simulator",zipcode:n(this).closest(".wc-shipping-simulator").find("#zipcode").val(),product_id:product_id,global_product:wc_shipping_simulator.product_id,variation_id:n(i).find('.cart input[name="variation_id"]').val(),product_quantity:1===n(i).find('.cart input[name="quantity"]').length?n(i).find('.cart input[name="quantity"]').val():1,all_fields:all_fields,type:type};n.ajax({type:"GET",url:wc_shipping_simulator.ajax_url,cache:!1,dataType:"json",data:t,beforeSend:function(){button.attr("disabled","disabled")},success:function(i){button.removeClass("loading"),button.removeAttr("disabled"),simulator.removeClass("loading"),n(document.body).trigger("wc_shipping_simulator_success",[i,simulator])},error:function(){n(document.body).trigger("wc_shipping_simulator_error",[t,simulator]),button.removeClass("loading"),simulator.removeClass("loading"),button.removeAttr("disabled")}})})}),jQuery(function(e){({init:function(){e(document.body).on("wc_shipping_simulator_success",this.success),e(document.body).on("wc_shipping_simulator_error",this.error),e(document.body).on("click",".wc-shipping-simulator-collapsed-handler",this.collapsed)},collapsed:function(i){i.preventDefault(),e(this).closest("#wc-shipping-simulator").toggleClass("wc-shipping-simulator-collapsed")},success:function(i,t,s){var o,n=s.find("#fshipping-results");0<t.error.length&&n.prepend('<div class="error">'+t.error+"</div>"),""!=t.rates&&(o="",o+='<table class="table-freight"><thead><tr><th>Tipo de entrega</th><th>Custo</th></tr></thead><tbody>',e.each(t.rates,function(i,t){o=(o=(o+='<tr class="'+t.method_id+'">')+"<td>"+t.label+"</td>")+"<td>"+t.cost+"</td></tr>"}),""!=t.shipping_to&&(o+='<tr class="shipping-to"><td colspan="3">'+t.shipping_to+"</td></tr>"),o+="</tbody></table>",e(document.body).trigger("wc_shipping_simulator",t,s),n.prepend(o),e(document.body).trigger("wc_shipping_simulator_after",t,s))},error:function(i){content.prepend('<div class="error">'+wc_shipping_simulator.error_message+"</div>")}}).init()});